(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{283:function(s,n,t){"use strict";t.r(n);var a=t(14),e=Object(a.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"项目简介"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#项目简介"}},[s._v("#")]),s._v(" 项目简介")]),s._v(" "),n("blockquote",[n("p",[n("strong",[s._v("官网首页：")]),s._v(" https://www.kolento.cn (域名已过期) "),n("br"),s._v(" "),n("strong",[s._v("后台管理系统：")]),s._v(" vue2.x + ele 开发 "),n("br"),s._v(" "),n("strong",[s._v("二次元番剧 小程序：")]),s._v(" ui框架：vant webapp "),n("br"),s._v(" "),n("strong",[s._v("后台支持：")]),s._v(" node "),n("br"),s._v(" "),n("strong",[s._v("数据来源：")]),s._v(" api接口转发+puppeteer爬虫 "),n("br"),s._v(" "),n("strong",[s._v("数据库：")]),s._v(" mysql8.0.22 "),n("br"),s._v(" "),n("strong",[s._v("数据库可视化软件：")]),s._v(" dbeaver "),n("br")])]),s._v(" "),n("p",[n("strong",[s._v("此笔记 主要用于记录 个人项目 的搭建的流程")]),s._v(" "),n("br")]),s._v(" "),n("h2",{attrs:{id:"准备工作"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#准备工作"}},[s._v("#")]),s._v(" 准备工作")]),s._v(" "),n("h3",{attrs:{id:"一、购买域名"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#一、购买域名"}},[s._v("#")]),s._v(" 一、购买域名")]),s._v(" "),n("p",[n("strong",[s._v("域名：")]),s._v(" kolento.club / kolento.cn  "),n("br"),s._v(" "),n("strong",[s._v("到期时间：")]),s._v(" 2021-05-31  "),n("br"),s._v(" "),n("strong",[s._v("购买渠道：")]),s._v(" 百度云 / 腾讯云  "),n("br"),s._v(" "),n("strong",[s._v("域名备案：")]),s._v(" （申请备案→填写信息→审核、最好上传域名证书，证书从域名购买处查找）  "),n("br"),s._v(" "),n("strong",[s._v("SSL证书：")]),s._v(" http转https，现申请了腾讯云的免费一年SSL证书，2022年1月25日到期  "),n("br"),s._v(" "),n("strong",[s._v("申请SSL证书流程：")]),s._v(" 申请→下载→解压找到nginx文件夹下内容复制进项目文件夹下（node项目中）  "),n("br")]),s._v(" "),n("h3",{attrs:{id:"二、百度云-腾讯云架设node开发环境-建议系统centos8"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#二、百度云-腾讯云架设node开发环境-建议系统centos8"}},[s._v("#")]),s._v(" 二、百度云/腾讯云架设node开发环境（建议系统centos8）")]),s._v(" "),n("p",[n("strong",[s._v("远程服务器连接工具：")]),s._v(" xShell6 "),n("br"),s._v(" "),n("strong",[s._v("数据库连接工具：")]),s._v(" dbeaver "),n("br"),s._v(" "),n("strong",[s._v("用户名：")]),s._v(" root "),n("br"),s._v(" "),n("strong",[s._v("密码：")]),s._v(" xxxxxx "),n("br")]),s._v(" "),n("h4",{attrs:{id:"搭建node环境"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#搭建node环境"}},[s._v("#")]),s._v(" 搭建node环境")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("https://nodejs.org/dist/latest/\n下载nodejs（老版本）\nwget https://nodejs.org/dist/v10.15.0/node-v10.15.0-linux-x64.tar.xz\n如果报错\nwget --no-check-certificate https://nodejs.org/dist/v10.15.0/node-v10.15.0-linux-x64.tar.xz\n下载nodejs（新版本 推荐使用新版本）\nwget https://nodejs.org/dist/latest/node-v15.12.0-linux-x64.tar.xz\n解压与安装node\nxz -d node-v15.12.0-linux-x64.tar.xz\n新版本：tar -xf node-v15.12.0-linux-x64.tar\n这里可以选择修改文件夹名字方便后面输入命令，修改文件夹名字为nodebox\nmv node-v15.12.0-linux-x64 nodebox\n映射node与npm（映射需要观察/nodebox/bin/下是否有node命令用于映射）\nln -s /nodebox/bin/node /usr/bin/node \nln -s /nodebox/bin/npm /usr/bin/npm\n安装淘宝镜像，然后进行映射\nln -s /nodebox/bin/cnpm /usr/bin/cnpm\n如果成功，则测试是否安装成功检测版本号\nnode -v\nnpm -v\n如果不成功，删除原有映射，重新映射尝试\n进入需要删除的映射文件夹\ncd /usr/bin\nrm -rf ./node (删除node映射为例)\n下载解压yum并且安装 用于安装其他软件\nwget http://yum.baseurl.org/download/3.2/yum-3.2.28.tar.gz\ntar xvf yum-3.2.28.tar.gz \n进入目录运行安装\ncd yum-3.2.28  \n安装git和pm2\nyum install git\nyum install pm2\n如果yum安装不成功使用npm安装\nnpm install -g  pm2\n如果pm2显示没不存在命令\n执行映射 \nln -s /nodebox/bin/pm2 /usr/bin/pm2\npm2开命令：\n全部停止：pm2 stop all\n全部开启：pm2 start all\n显示pm2列表：pm2 list\n参考链接（可用）\nhttps://blog.csdn.net/putao2062/article/details/79647597\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br")])]),n("h3",{attrs:{id:"三、服务器安装mysql8-0"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#三、服务器安装mysql8-0"}},[s._v("#")]),s._v(" 三、服务器安装mysql8.0")]),s._v(" "),n("blockquote",[n("p",[s._v("如果使用的是cenos7版本会在安装的时候提示缺包，不能安装此版本 "),n("br"),s._v("\ncentos8安装mysql8.0.22，在kolento目录下的mysql8.0目录下进行")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("1.下载\nwget https://dev.mysql.com/get/mysql80-community-release-el8-1.noarch.rpm\n2.安装数据源\nyum install mysql80-community-release-el8-1.noarch.rpm\n3.检查数据源、查看mysql源是否安装成功：\nyum repolist enabled | grep \"mysql.*-community.*\"\n4.禁用CentOS8自带mysql模块\nyum module disable mysql\n5.安装数据库、真正安装mysql\n安装语句：yum install mysql-community-server\n6.启动数据库\nservice mysqld start\nservice mysqld status\n7.显示mysql的随机密码\ngrep 'temporary password' /var/log/mysqld.log\n此时会显示出当前生成的随机密码用这个密码登录后再次修改为简单的密码\n\n8.登录并且修改mysql密码\n登录：mysql -u root -p\n然后输入上面生成的密码\n9.修改密码\nALTER USER 'root'@'localhost' IDENTIFIED BY 'Root_21root';（设置密码 Root_21root）\nssh服务器上登录密码：Root_21root\n10.查看密码策略\nSHOW VARIABLES LIKE 'validate_password%';\n11.修改密码策略\n 修改密码长度：set global validate_password.length=1;（长度）\n修改密码等级：set global validate_password.policy=0;（等级）\n并且再次进行查看确认是否修改成功\n12.Mysql8.0.22开放远程访问\n先创建权限记录：create user 'root'@'%' identified by 'root123';\n13.设置自己的密码\nALTER USER 'root'@'%' IDENTIFIED BY '123456';\n原文中%为local，应改成%，否则node连不上远程数据库\n授权：grant all privileges on *.* to 'root'@'%' with grant option;\n14.开放防火墙端口\n由于mysql8.0的加密方法变了。mysql8.0默认采用caching_sha2_password的加密方式。sqlyog不支持这种加密方式。\n修改密码过期\nALTER USER'root'@'%' IDENTIFIED BY '123456' PASSWORD EXPIRE NEVER;\n重新修改密码\nALTER USER'root'@'%' IDENTIFIED WITH mysql_native_password BY '123456';\n刷新权限（不做可能无法生效）\nFLUSH PRIVILEGES;\n参考地址：https://www.cnblogs.com/zhulei2/p/13912167.html\n登录本机mysql：mysql -uroot -p\n停止mysql服务：service mysqld stop\n开启mysql服务：service mysqld start\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br")])]),n("h2",{attrs:{id:"node项目配置与开发"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#node项目配置与开发"}},[s._v("#")]),s._v(" node项目配置与开发")]),s._v(" "),n("ol",[n("li",[n("p",[s._v("开发"),n("strong",[s._v("api.js")]),s._v(" "),n("br"),s._v("\n用于爬虫爬取所需数据并且存入数据库（puppeteer）每日定时执行,爬取最新信息。")])]),s._v(" "),n("li",[n("p",[s._v("开发"),n("strong",[s._v("serve.js")]),s._v(" "),n("br"),s._v("\n建立数据库连接，开发接口，转发接口，允许跨域")])])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" mysql "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'mysql'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" db "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("createConnection")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  host     "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'106.12.xx.xx'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  user     "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  password "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'xxxxxx'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  port     "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  database "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'kolento'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("并且引入静态资源")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[s._v("app"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("use")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("express"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("static")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./public'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("读取"),n("strong",[s._v("public")]),s._v("文件下的"),n("strong",[s._v("index.html")]),s._v("使得网站可以被访问 "),n("br"),s._v("\n3. SSL证书配置与"),n("strong",[s._v("start.js")]),s._v("开发\n"),n("strong",[s._v("public")]),s._v(" 文件夹下放入下载的证书和打包好的网页文件 "),n("br"),s._v("\n引入相关文件，导入"),n("strong",[s._v("serve.js")]),s._v("中暴露的"),n("strong",[s._v("app")]),s._v("并且开启"),n("strong",[s._v("https")]),s._v("服务 "),n("br")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" httpsOption "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    key "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" fs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("readFileSync")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./public/SSL/Nginx/2_kolento.club.key"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    cert"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" fs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("readFileSync")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./public/SSL/Nginx/1_kolento.club_bundle.crt"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("创建服务，默认80端口")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[s._v("http"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("createServer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("app"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("listen")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nhttps默认"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v("端口\nhttps"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("createServer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("httpsOption"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" app"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("listen")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("本地运行 "),n("code",[s._v("node start")]),s._v(" 测试是否成功")]),s._v(" "),n("h2",{attrs:{id:"开启node服务"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#开启node服务"}},[s._v("#")]),s._v(" 开启node服务")]),s._v(" "),n("ol",[n("li",[s._v("在根目录创建文件夹 "),n("code",[s._v("mkdir kolento")]),s._v(" "),n("br"),s._v(" "),n("strong",[s._v("kolento")]),s._v(" 下创建2个文件夹一个 "),n("strong",[s._v("node20201")]),s._v(" 用于存放项目、一个 "),n("strong",[s._v("mysql8.0")]),s._v(" 用于放置 "),n("strong",[s._v("mysql")]),s._v(" "),n("br")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("https://github.com/xxxxxx/node2021.git\n开始拉取安装已开发打包的项目\ncd node2021\ngit init 初始化仓库\ngit pull https://github.com/xxxxxx/node2021.git\n安装淘宝镜像\nnpm install -g cnpm --registry=https://registry.npm.taobao.org\ncnpm install\nnode start 尝试启动start.js查看是否可以正常运行\n使用pm2永久开启服务\n需要开启服务的js文件：start.js\npm2 start start.js\n查看pm2服务列表：\npm2 list\npm2 stop all\npm2 start all\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("h2",{attrs:{id:"问题总结"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#问题总结"}},[s._v("#")]),s._v(" 问题总结")]),s._v(" "),n("ul",[n("li",[s._v("主要是 "),n("strong",[s._v("puppetter")]),s._v("和"),n("strong",[s._v("linux")]),s._v("相关问题 "),n("br")])]),s._v(" "),n("ol",[n("li",[s._v("async外不要使用console "),n("br")]),s._v(" "),n("li",[s._v("不渲染chrome浏览器，linux没有图形化组件 "),n("br")])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" browser "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("await")]),s._v(" puppeteer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("launch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      headless"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      args"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--no-sandbox'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--disable-setuid-sandbox'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// puppeteerOptions: {")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//   ignoreHTTPSErrors: true,")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//   dumpio: false,")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("ol",{attrs:{start:"3"}},[n("li",[s._v("安装相关puppeteer在linux下的依赖")])]),s._v(" "),n("h4",{attrs:{id:"依赖库"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#依赖库"}},[s._v("#")]),s._v(" 依赖库")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("yum install pango.x86_64 libXcomposite.x86_64 libXcursor.x86_64 libXdamage.x86_64 libXext.x86_64 libXi.x86_64 libXtst.x86_64 cups-libs.x86_64 libXScrnSaver.x86_64 libXrandr.x86_64 GConf2.x86_64 alsa-lib.x86_64 atk.x86_64 gtk3.x86_64 -y\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h4",{attrs:{id:"字体库"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#字体库"}},[s._v("#")]),s._v(" 字体库")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("yum install ipa-gothic-fonts xorg-x11-fonts-100dpi xorg-x11-fonts-75dpi xorg-x11-utils xorg-x11-fonts-cyrillic xorg-x11-fonts-Type1 xorg-x11-fonts-misc -y\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("其中"),n("code",[s._v("ipa-gothic-fonts")]),s._v("需要手动下载安装\n4. 如果提示缺少组件按照缺少的组件进行安装")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("(node:201386) ExperimentalWarning: The fs.promises API is experimental\n\n(node:201386) UnhandledPromiseRejectionWarning: Error: Failed to launch the browser process!\n\n/kolento/node2021/node_modules/_puppeteer@5.5.0@puppeteer/.local-chromium/linux-818858/chrome-linux/chrome: error while loading shared libraries: libgbm.so.1: cannot open shared object file: No such file or directory\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h4",{attrs:{id:"解决方案"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#解决方案"}},[s._v("#")]),s._v(" 解决方案")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("yum install libgbm  -y\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h2",{attrs:{id:"其他问题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#其他问题"}},[s._v("#")]),s._v(" 其他问题")]),s._v(" "),n("ol",[n("li",[s._v("如何进行ip动态代理更换提高爬虫的效率（付费代理池）"),n("br")]),s._v(" "),n("li",[s._v("Error: Node is either not visible or not an HTMLElement"),n("br")])]),s._v(" "),n("h4",{attrs:{id:"解决方案-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#解决方案-2"}},[s._v("#")]),s._v(" 解决方案：")]),s._v(" "),n("p",[s._v("添加登录的模拟操作步骤 "),n("br")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("await")]),s._v(" page"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("waitForSelector")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.more:not(:empty)'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" timeout"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("120000")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" visible"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("本机调用爬虫，不在服务端进行running")]),s._v(" "),n("h2",{attrs:{id:"cdn资源管理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#cdn资源管理"}},[s._v("#")]),s._v(" CDN资源管理")]),s._v(" "),n("ul",[n("li",[s._v("信息均已过期\n腾讯云cdn 3元/50g "),n("br"),s._v("\n购买日期：2月5日，过期时间22年2月5日 "),n("br"),s._v("\nhttps://console.cloud.tencent.com/ "),n("br")])]),s._v(" "),n("p",[s._v("腾讯云控制台子用户登录页面： "),n("br"),s._v("\nhttps://cloud.tencent.com/login/subAccount/100003948444?type=subAccount "),n("br")]),s._v(" "),n("h2",{attrs:{id:"云服务器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#云服务器"}},[s._v("#")]),s._v(" 云服务器")]),s._v(" "),n("p",[n("strong",[s._v("有效日期：")]),s._v(" 2021/319--2023/3/19 "),n("br")]),s._v(" "),n("h2",{attrs:{id:"公安备案"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#公安备案"}},[s._v("#")]),s._v(" 公安备案")]),s._v(" "),n("ul",[n("li",[s._v("信息均已过期\n"),n("strong",[s._v("备案地址：")]),s._v(" "),n("a",{attrs:{href:"http://www.beian.gov.cn/portal/index?login=Y&token=f77071a7-08b4-489d-bb75-6e64a3094449&info=%E6%B3%A8%E5%86%8C%E6%88%90%E5%8A%9F%EF%BC%81",target:"_blank",rel:"noopener noreferrer"}},[s._v("备案地址"),n("OutboundLink")],1),s._v(" "),n("br")])]),s._v(" "),n("h2",{attrs:{id:"开发工作"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#开发工作"}},[s._v("#")]),s._v(" 开发工作")]),s._v(" "),n("h4",{attrs:{id:"小程序-注意的问题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#小程序-注意的问题"}},[s._v("#")]),s._v(" 小程序 注意的问题")]),s._v(" "),n("ol",[n("li",[s._v("ios不支持webp格式的图片 "),n("br")]),s._v(" "),n("li",[s._v("wxml中调用js或者写表达式的方法  "),n("br")]),s._v(" "),n("li",[s._v("后台设置中bangumi https和ic备案问题 "),n("br")])])])}),[],!1,null,null,null);n.default=e.exports}}]);